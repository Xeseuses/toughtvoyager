{{ define "main" }}
<main style="max-width: 750px; margin: auto; padding: 2rem; font-family: 'Segoe UI', sans-serif; background: #f4f8f5;">

  <style>
    article {
      animation: fadein 0.5s ease forwards;
    }
    h1 {
      font-size: 2.4rem;
      margin-bottom: 0.3rem;
      color: #2c3e50;
    }
    .meta, .stage {
      color: #666;
      margin-bottom: 0.25rem;
      font-size: 0.95rem;
    }
    .stage {
      color: #3b7a57;
      font-weight: 500;
    }
    .content {
      line-height: 1.7;
      font-size: 1.05rem;
      color: #333;
      margin-top: 2rem;
    }
    .content img {
      max-width: 100%;
      border-radius: 8px;
      margin: 1.5rem 0;
    }
    .content blockquote {
      border-left: 4px solid #ccc;
      padding-left: 1rem;
      margin: 1rem 0;
      color: #555;
      font-style: italic;
    }
    .taglist {
      margin-top: 3rem;
      color: #666;
    }
    .taglist span {
      background: #eef;
      color: #336;
      padding: 0.25rem 0.5rem;
      margin-right: 0.5rem;
      border-radius: 6px;
      font-size: 0.9rem;
    }
    .related {
      margin-top: 3rem;
    }
    .related h3 {
      font-size: 1.2rem;
      color: #2c3e50;
      margin-bottom: 0.75rem;
    }
    .related ul {
      padding-left: 1.2rem;
    }
    .related li {
      margin-bottom: 0.3rem;
    }
    @keyframes fadein {
      from { opacity: 0; }
      to { opacity: 1; }
    }
  </style>

  <article>
    <h1>{{ .Title }}</h1>
    {{ with .Params.stage }}
      <div class="stage">{{ . }}</div>
    {{ end }}
    <div class="meta">
      {{ .Date.Format "Jan 2, 2006" }} · ⏱️ {{ .ReadingTime }} min read
    </div>
    <p style="font-size:0.85rem; color:#888; margin-top: 3rem;">
      Last tended: {{ .Lastmod.Format "Jan 2, 2006" }}
    </p>

    {{ $content := .Content | replaceRE "\\[\\[([^\\]]+)\\]\\]" "<a href=\"/$1\">$1</a>" }}
    <div class="content">
      {{ $content | safeHTML }}
    </div>

    {{ with .Params.tags }}
    <div class="taglist">
      <strong>Tagged:</strong>
      {{ range . }}<span>{{ . }}</span>{{ end }}
    </div>
    {{ end }}

    {{ partial "related.html" . }}

 </article>
</main>
{{ end }}

